(module test_runner_simple
  (import string_utils)
  (import conversion)
  
  (fn print_banner -> int
    (call print "AISL Test Framework Runner")
    (call print "===========================")
    (ret 0))
  
  (fn compile_test file string -> bool
    (set output string "/tmp/test_output.aislc")
    
    (set args array (call array_new 10))
    (call array_push args file)
    (call array_push args output)
    
    (set exit_code int (call process_exec "./compiler/c/bin/aislc" args))
    
    (set success bool (call eq exit_code 0))
    (ret success))
  
  (fn extract_test_name file string -> string
    (set name string (call string_replace file "tests/" ""))
    (set name string (call string_replace name ".aisl" ""))
    (ret name))
  
  (fn main -> int
    (call print_banner)
    (call print "")
    
    (call print "Testing: test_simple.aisl")
    (set result1 bool (call compile_test "tests/test_simple.aisl"))
    (if result1
      (call print "  PASS")
      (call print "  FAIL"))
    
    (call print "Testing: test_if.aisl")
    (set result2 bool (call compile_test "tests/test_if.aisl"))
    (if result2
      (call print "  PASS")
      (call print "  FAIL"))
    
    (call print "Testing: test_while_simple.aisl")
    (set result3 bool (call compile_test "tests/test_while_simple.aisl"))
    (if result3
      (call print "  PASS")
      (call print "  FAIL"))
    
    (call print "")
    (call print "Done - tested 3 files")
    (ret 0))
  
  (meta-note "Simple AISL test runner - tests a few files to verify process_exec works"))
