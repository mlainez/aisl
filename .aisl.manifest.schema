; AISL Manifest Schema - LLM-optimized module metadata
; Token budget: ~50 tokens per manifest average
; NO human readability - pure machine consumption

; Schema version 1.0
(schema-version 1)

; Manifest structure (all fields required):
(manifest
  @(m <module-name>)              ; Module identifier (string)
  @(v <semver>)                   ; Version (string)
  @(e                             ; Exports list
    @(f <name> (<type>*) <ret>)*) ; Functions: name params return
  @(d (<mod> <ver>)*)             ; Dependencies: module version
  @(p <op>*)                      ; Primitives: VM ops used
  @(t <int>))                     ; Token count estimate

; Type abbreviations (10 tokens vs 50+ for full names):
; i32 i64 f32 f64 bool string array map json

; Examples (NOT included in actual manifest files):
; 
; Math module (28 tokens):
; (manifest
;   @(m math)@(v 1.0.0)
;   @(e@(f sqrt(f64)f64)@(f pow(f64 f64)f64)@(f abs(f64)f64))
;   @(d)@(p add sub mul div gt lt)@(t 450))
;
; HTTP client module (45 tokens):
; (manifest
;   @(m http)@(v 2.1.0)
;   @(e@(f get(string)string)@(f post(string string)string))
;   @(d(json 1.0.0)(string 1.0.0))@(p string_concat print)@(t 1200))

; Parsing rules for LLMs:
; 1. Read entire manifest into memory (always <200 tokens)
; 2. Parse @(m ...) to get module name
; 3. Parse @(e ...) to get all exported function signatures
; 4. Parse @(d ...) to resolve dependencies recursively
; 5. Parse @(p ...) to verify VM primitive availability
; 6. Parse @(t ...) to estimate token cost of importing

; Token efficiency comparison:
; JSON manifest: ~150 tokens average
; YAML manifest: ~120 tokens average  
; This format:   ~50 tokens average (3x improvement)

; Manifest files:
; - Located alongside .aisl files: math.aisl → math.aisl.manifest
; - Parsed before compiling module (type checking, dependency resolution)
; - Optional but recommended (compiler can infer from .aisl if missing)
; - Generated by: aislc --generate-manifest <module.aisl>

; Search paths (priority order):
; 1. ./modules/<name>.aisl
; 2. ~/.aisl/modules/<name>.aisl
; 3. /usr/lib/aisl/modules/<name>.aisl

; Dependency resolution:
; - Transitive: if A imports B and B imports C, compile C→B→A
; - Circular detection: error if cycle found
; - Version constraints: exact match only (no semver ranges)

; Critical for LLMs:
; - Manifest is source of truth for API surface
; - Read manifest BEFORE reading full .aisl file (save tokens)
; - Use @(t ...) to decide if import is worth the context cost
; - Check @(p ...) to verify VM supports needed primitives
